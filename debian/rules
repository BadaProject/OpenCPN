#!/usr/bin/make -f

include /usr/share/dpkg/architecture.mk
#DEB_UPSTREAM_VERSION=$(shell dpkg-parsechangelog | sed -rne 's,^Version: ([0-9]:)*([^-]+).*,\2,p')
DEB_UPSTREAM_VERSION=12

echo $(DEB_UPSTREAM_VERSION)

%:
	dh $@


override_dh_auto_configure:
ifeq ($(DEB_BUILD_ARCH_CPU), arm)
	dh_auto_configure -- \
	    -DCMAKE_LIBRARY_PATH=$(DEB_HOST_MULTIARCH) \
            -DOCPN_ENABLE_SYSTEM_CMD_SOUND:BOOL=ON     \
            -DCMAKE_INSTALL_LIBDIR=lib                 \
            -DCMAKE_BUILD_TYPE=Release                 \
            -DOCPN_BUILD_TEST=OFF
else ifeq ($(DEB_BUILD_ARCH_CPU), aarch64)
	dh_auto_configure -- \
	    -DCMAKE_LIBRARY_PATH=$(DEB_HOST_MULTIARCH) \
            -DOCPN_ENABLE_SYSTEM_CMD_SOUND:BOOL=ON     \
            -DCMAKE_INSTALL_LIBDIR=lib                 \
            -DCMAKE_BUILD_TYPE=Release                 \
            -DOCPN_BUILD_TEST=OFF
else ifeq ($(DEB_BUILD_ARCH_CPU), arm64)
	dh_auto_configure -- \
	    -DCMAKE_LIBRARY_PATH=$(DEB_HOST_MULTIARCH) \
            -DOCPN_ENABLE_SYSTEM_CMD_SOUND:BOOL=ON     \
            -DCMAKE_INSTALL_LIBDIR=lib                 \
            -DCMAKE_BUILD_TYPE=Release                 \
            -DOCPN_BUILD_TEST=OFF
else
  ifeq ($(DEB_UPSTREAM_VERSION), 12)
	dh_auto_configure -- \
	    -DCMAKE_INSTALL_LIBDIR=lib                 \
            -DCMAKE_BUILD_TYPE=Release                 \
            -DOCPN_BUILD_TEST=OFF		       \
            -DOCPN_TARGET_TUPLE="ubuntu-x86_64-wx32;22.04;x86_64"
  else
 	dh_auto_configure -- \
	    -DCMAKE_INSTALL_LIBDIR=lib                 \
            -DCMAKE_BUILD_TYPE=Release                 \
            -DOCPN_BUILD_TEST=OFF


endif
